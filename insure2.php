<?php
  // 检测输入类型
    $x_arr = array(
        2500
        ,3750
        ,4250
        ,4500
        ,4500
        ,4750
        ,4750
        ,4750
        ,4750
        ,4750
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
         ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0        
    );
    $y_arr = array(
        2.77
        ,1.86
        ,1.31
        ,0.97
        ,0.73
        ,0.57
        ,0.46
        ,0.38
        ,0.31
        ,0.27
        ,0.25
        ,0.24
        ,0.25
        ,0.27
        ,0.30
        ,0.34
        ,0.38
        ,0.42
        ,0.45
        ,0.48
        ,0.50
        ,0.51
        ,0.52
        ,0.52
        ,0.52
        ,0.52
        ,0.52
        ,0.52
        ,0.53
        ,0.55
        ,0.57
        ,0.59
        ,0.63
        ,0.71
        ,0.77
        ,0.84
        ,0.91
        ,1.00
        ,1.10
        ,1.21
        ,1.33
        ,1.47
        ,1.62
        ,1.79
        ,1.98
        ,2.19
        ,2.42
        ,2.68
        ,2.96
        ,3.28
        ,3.63
        ,4.01
        ,4.44
        ,4.92
        ,5.44
        ,6.02
        ,6.66
        ,7.37
        ,8.15
        ,9.02
        ,9.98
        ,11.04
        ,12.21
        ,13.50
        ,14.93
        ,16.50
        ,18.24
        ,20.16
        ,22.28
        ,24.61
        ,27.18
        ,30.01
        ,33.12
        ,36.55
        ,40.31
        ,44.45
        ,48.98
        ,53.96
        ,59.41
        ,65.36
        ,71.88
        ,78.98

            );
    $a_arr = array(
        1.59
        ,0.95
        ,0.92
        ,0.89
        ,0.87
        ,0.84
        ,0.83
        ,0.81
        ,0.81
        ,0.80
        ,0.80
        ,0.81
        ,0.81
        ,0.83
        ,0.86
        ,0.87
        ,0.90
        ,0.93
        ,0.96
        ,1.01
        ,1.04
        ,1.07
        ,1.10
        ,1.13
        ,1.17
        ,1.22
        ,1.26
        ,1.32
        ,1.40
        ,1.51
        ,1.63
        ,1.75
        ,1.90
        ,2.05
        ,2.23
        ,2.38
        ,2.57
        ,2.81
        ,3.06
        ,3.29
        ,3.56
        ,3.87
        ,4.17
        ,4.53
        ,4.93
        ,5.35
        ,5.79
        ,6.23
        ,6.78
        ,7.30
        ,7.91
        ,8.43
        ,9.04
        ,9.58
        ,10.27
        ,10.89
        ,11.63
        ,12.26
        ,13.15
        ,14.48
        ,15.95
        ,17.28
        ,18.02
        ,19.07
        ,20.09
        ,20.70
        ,21.77
        ,23.48
        ,25.41
        ,27.11
        ,28.18
        ,28.82
        ,29.53
        ,30.25
        ,30.98
        ,31.65
        ,32.87
        ,35.79
        ,39.13
        ,41.96
        ,43.40
        ,44.17
        ,44.46
        ,44.67
        ,44.86
        ,45.62
        ,46.40
        ,47.18
        ,47.98
        ,48.80
        ,49.66
        ,50.54
        ,51.46
        ,52.42
        ,53.42
        ,54.46
        ,55.54
 
    );
    //var_dump(count($x_arr),count($y_arr),count($a_arr));exit;
    $z_arr = array();
    $p_arr = array();
    $q_arr = array();
    $r_arr = array();
    $x_sum = 0;
    $z_sum = 0;
    $n = 183;
    $o = 0;
    $temp = 0;


    for ($i = 0; $i< count($y_arr) -1; $i++){
    //for ($i = 0; $i< 50; $i++){
        $x_sum += $x_arr[$i];
        $p_arr[$i] = (100000 - $x_sum) * $y_arr[$i]/1000 ;
        $q_arr[$i] = (80000 - $x_sum) * $a_arr[$i]/1000 ;

        if ($i == 0){
            $z_arr[0] = $x_arr[0] *1.045 - $p_arr[0] - $q_arr[0] - $n;
        }else{
            if($i >= 1 && $i <=9 ){
                $z_arr[$i] = ($z_arr[$i-1] +$x_arr[$i])*1.045 - $p_arr[$i] - $q_arr[$i] - $n;
            }else{
                $z_arr[$i] = ($z_arr[$i-1] +$x_arr[$i])*1.045 - $p_arr[$i] - $q_arr[$i];
            }    
        }    
        $z_sum += $z_arr[$i]; 
        //$q_arr[$i] = $z_sum - $p_arr[$i];
        //$x_arr[$i+1] = $q_arr[$i];
        
        array_push($p_arr,$p_arr[$i]);
        array_push($z_arr,$z_arr[$i]);
        array_push($q_arr,$q_arr[$i]);
        array_push($r_arr,array('n'.$i => $i,
                                'x'.$i => $x_arr[$i],
                                'z'.$i => $z_arr[$i],
                                'p'.$i => $p_arr[$i],
                                'q'.$i => $q_arr[$i],
                            ) 
        );
       if($o <= $z_arr[$i]){
            $o = $z_arr[$i];
            $temp = $i;
        }else{
            continue;
        }

        //var_dump($x_arr[$i]);
        //var_dump($z_sum);

    
    }
    $z_max = max($z_arr);
    $x_max = max($x_arr);

    //var_dump($x_arr[0], $y_arr[0], $z_arr[0], $p_arr[0], $q_arr[0]);
    /*
    echo json_encode(array(
                     'p' => $p_arr,
                     'q' => $q_arr,
                     'x' => $x_arr,
                     'z' => $z_arr));
    */
    echo json_encode(array('r' => $r_arr,
                            'n' => $temp,
                            'z_max' => $z_max
                        )
                    );

?>


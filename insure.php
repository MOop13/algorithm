<?php
  // 检测输入类型
    $x_arr = array(2000
        ,3000
        ,3400
        ,3600
        ,3600
        ,3800
        ,3800
        ,3800
        ,3800
        ,3800
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0
        ,0        
    );
    $y_arr = array(
        1.06
        ,1.14
        ,1.22
        ,1.32
        ,1.44
        ,1.56
        ,1.71
        ,1.87
        ,2.05
        ,2.25
        ,2.47
        ,2.71
        ,2.98
        ,3.28
        ,3.60
        ,3.96
        ,4.35
        ,4.78
        ,5.26
        ,5.78
        ,6.36
        ,6.99
        ,7.69
        ,8.45
        ,9.29
        ,10.21
        ,11.22
        ,12.33
        ,13.55
        ,14.89
        ,16.36
        ,17.97
        ,19.74
        ,21.68
        ,23.80
        ,26.13
        ,28.67
        ,31.46
        ,34.50
        ,37.83
        ,41.47
        ,45.45
        ,49.78
        ,54.50
        ,59.64
        ,65.24
        ,71.32
        ,77.92
        ,85.07
        ,92.81
        ,101.18
    );
    $a_arr = array(
    1.78
,1.87
,1.98
,2.12
,2.24
,2.38
,2.59
,2.81
,3.02
,3.30
,3.60
,3.97
,4.40
,4.88
,5.42
,6.03
,6.69
,7.50
,8.32
,9.31
,10.26
,11.39
,12.45
,13.81
,15.10
,16.65
,18.06
,19.80
,21.99
,24.37
,26.65
,28.19
,29.40
,31.02
,32.16
,33.77
,35.35
,37.36
,39.96
,42.71
,45.21
,47.04
,48.40
,49.73
,50.96
,52.19
,53.31
,54.20
,57.30
,60.70
,63.47
,64.76
,64.92
,65.01
,65.02
,65.02
,65.02
,65.70
,66.37
,68.49
,70.74
,73.15
,75.72
,78.40
,81.21
,84.15
,87.22
,90.43
,93.76
 
    );
    $z_arr = array();
    $p_arr = array(0);
    $q_arr = array();
    $r_arr = array();
    $x_sum = 0;
    $z_sum = 0;
    $m = 120;
    $n = 115;
    $o = 0;
    $temp = 0;

    for ($i = 0; $i< count($y_arr) -1; $i++){
    //for ($i = 0; $i< 50; $i++){
        $x_sum += $x_arr[$i];
        $p_arr[$i] = (150000 - $x_sum) * $y_arr[$i]/1000 ;
        $q_arr[$i] = (100000 - $x_sum) * $a_arr[$i]/1000 ;

        if ($i == 0){
            $z_arr[0] = $x_arr[0] *1.045 - $p_arr[0] - $q_arr[0] - $m - $n;
        }else{
            if ($i >=1 && $i <=9){
                $z_arr[$i] = ($z_arr[$i-1] +$x_arr[$i])*1.045 - $p_arr[$i] - $q_arr[$i] - $m - $n;
            }else{
                $z_arr[$i] = ($z_arr[$i-1] +$x_arr[$i])*1.045 - $p_arr[$i] - $q_arr[$i];
            }    
        }    
        $z_sum += $z_arr[$i]; 
        //$q_arr[$i] = $z_sum - $p_arr[$i];
        //$x_arr[$i+1] = $q_arr[$i];
        
        array_push($p_arr,$p_arr[$i]);
        array_push($z_arr,$z_arr[$i]);
        array_push($q_arr,$q_arr[$i]);
        array_push($r_arr,array('n'.$i => $i,
                                'x'.$i => $x_arr[$i],
                                'z'.$i => $z_arr[$i],
                                'p'.$i => $p_arr[$i],
                                'q'.$i => $q_arr[$i],
                            ) 
        );
        if($o <= $z_arr[$i]){
            $o = $z_arr[$i];
            $temp = $i;
        }else{
            continue;
        }
        //var_dump($x_arr[$i]);
        //var_dump($z_sum);

    
    }
    
    $z_max = max($z_arr);
    $x_max = max($x_arr);
    //var_dump($x_arr[0], $y_arr[0], $z_arr[0], $p_arr[0], $q_arr[0]);
    /*
    echo json_encode(array(
                     'p' => $p_arr,
                     'q' => $q_arr,
                     'x' => $x_arr,
                     'z' => $z_arr));
    */
    echo json_encode(array('r' => $r_arr,
                            'n' => $temp,
                            'z_max' => $z_max
                        )
                    );

?>

